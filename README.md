# C-facial_recognition
本仓库放置调用百度人脸识别api的Windows应用开发项目

## 项目概述
本项目主要是基于 C#、winForms 桌面应用和百度人脸识别 API 完成的。当运行项目时，会自动检测并且加载视频设备，使用 APP_ID、API_KEY、SECRET_KEY 连接百度人脸识别，当点击连接时，摄像头模块会为人脸登录和人脸注册模块提供实时视频流，人脸对比模块会选择用户本地的两张图片，同时转化为 base64 格式。再调用 match api 获取相似度等一系列信息。人脸注册模块会从摄像头模块捕获当前一帧，按照输入的 userinfo、group id 信息在人脸库注册。人脸登录模块会从摄像头模块捕获当前帧，调用 search api，返回检测结果，如果成功，则播放“认证成功”的提示音。

## 功能模块说明与核心代码
本项目主要涉及识别人脸、人脸比对、拍照、人脸注册、人脸登录等多个模块，同时使用了 AForge 库进行视频的捕获和处理，调用百度人脸识别 API 进行人脸识别
### 1.  识别图片模块
通过点击“识别图片”的 button 按钮，打开文件对话框，选择图片，为符合百度人脸识别 API 的参数要求，先将图片转化成 bitmap 格式，再将其编码为 Base64 字符串，再调用百度人脸识别 API 进行人脸检测，将检测结果以文本的形式显示在文本框textbox1 里面。检测结果主要为年龄、人脸的位置，美貌度，0-1 人体检查值等参数。
### 2. 人脸比对模块
用户通过点击“选择人脸”的 button 按钮，实现同识别图片的相似功能，业务逻辑设计也同识别图片。将两张图片的编码显示在文本框中，并调用百度人脸识别 API 接口
(Match 方法)进行人脸对比，在文本框 textbox1 里面给出人脸相似度等相关信息。
### 3. 拍照模块
当前点击“拍照”的 button5 按钮，会保存当前视频的一帧图像带指定文件夹下，同时断开视频设备的链接，关闭当前项目。
### 4. 人脸注册模块
将当前摄像头捕获的一帧人脸图片，注册到百度人脸库中，需要指定用户 ID、用户信息和用户组 ID。如果用户已经存在，则不再需要注册，可直接使用人脸登录。
### 5. 人脸登录模块
通过当前摄像设备捕获一帧人脸图像，用该图像与百度的指定组的人脸识别库 why_1中保存的人脸对比，如果相似度达到设定好的值，则认为匹配成功，在文本框 textbox7
里 面 显 示 相 应 的 用 户 名 , 并 同 时 播 放 “ 验 证 成 功 ” 的 提 示 音 （ 本 质 上 是 使 用
axWindowsMediaPlayer1 播放存储的 MP3 文件)。

## 运行结果及分析
### 识别图片效果
点击识别图片，从我的文件夹中上传一张我的图片，调用百度人脸识别 API 进行人脸检测，并将相关检测参数以字符串的形式展现在文本框。以下图片是识别图片的效果
展示。参数主要有人脸识别的成功与否，这里有“error_msg”为“success”成功检测
到人脸，“timetamp”为时间戳，“face_probability”是人体检测指数，范围为 0 到 1，参数越接近 1 则说明图片检测结果和人相似的结果越高，参数越接近 0 则说明图片检测结果和人相似的结果越低，“face_list”人脸的一系列位置参数。“age”为对人脸的年龄估计，“beauty”为对人脸的美貌度评分。

### 人脸对比功能效果
如果我选择两张一样的图片，效果如下：
可以发现两张图片的相似度评分“score”为 100.说明检测到两张图片是完全相同的。当我选择两张不同的我的照片时，两张图片的相识度评分降低到 95，可能是因为发型、衣着装扮、周围环境等多方面的因素影响，但基本上人的面部特征没有任何变化，可以认为是同一个人。

### 拍照功能的效果
首先点击连接设备，拍照，从当前视频捕获一帧人脸图像，保存至相应的文件路径下，同时断开视频设备的链接，关闭当前项目。以下是拍照功能的效果。

### 人脸注册的功能实现效果
连接视频设备，当前摄像头画面实时显示在videosoureplayer 控件里面，在用户分组文本框中输入你想要保存的组别 ID，输入用户姓名，就可以进行人脸注册了。此时会将以上信息保存至百度的人脸库。

### 人脸登录的功能实现
完成人脸认证之后，就可以进行人脸登录，点击登录按钮之后，会截取当前视频的某一帧图像，与百度的人脸库中的人脸对比，找到匹配的人脸信息之后，会返回用户名，
比如上图，就是识别到了我的人脸，给出了 why 的用户信息。则人脸登录成功。如果已经在人脸库中保存过人脸信息，则不需要人脸注册了，可以直接进行人脸登录。